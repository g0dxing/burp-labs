# Level 29 Writeup — 2FA 逻辑缺陷

## 关卡目标
- 发现并利用 2FA 流程中的逻辑漏洞（如验证窗口、重放、未绑定用户）。

## 场景概览
- 登录入口：`level29/login.html`
- 登录后端：`level29/login.php`
- 辅助文件：`level29/mfa.json`
- 登录成功页：`level29/welcome.html`

## 核心缺陷
- 2FA 验证码的生成/校验与用户会话绑定不足，或存在重放窗口。

## 攻击步骤
1. 获取或猜测验证码，尝试在不同会话/用户下复用。
2. 观察是否可在未完成或跳过 2FA 的情况下登录成功。

## 验证点与证据
- 抓包显示验证码可跨会话复用，或无需验证码即可进入成功页。

## 修复建议
- 将验证码强绑定用户与会话，设置严格有效期与一次性使用。
- 对重复尝试与失败次数实施限速与风控。

## 教学提示
- 2FA 的实现细节（绑定、过期、一次性）决定安全性高低。