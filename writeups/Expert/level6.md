# Level 6 Writeup — 2FA 简单绕过

## 关卡目标
- 找到 2FA 验证流程中的薄弱环节（如跳过验证、伪造状态、逻辑缺口）。

## 场景概览
- 登录入口：`Expert/level6/login.html`
- 登录后端：`Expert/level6/login.php`
- 2FA 验证：`Expert/level6/2fa.php`
- 账户页：`Expert/level6/account.php`

## 核心缺陷
- 2FA 验证状态可被绕过（例如仅依赖客户端标志、缺少二次校验、未绑定会话）。

## 攻击步骤
1. 正常登录后，拦截跳转至 2FA 的过程，尝试直接访问账户页或伪造会话标记。
2. 若后端只检查客户端参数或缺少会话绑定，可能直接通过。

## 验证点与证据
- 访问 `account.php` 是否无需有效的 2FA 验证状态；观察 Cookie/会话变量是否被验证。

## 修复建议
- 将 2FA 验证结果与服务端会话强绑定，账户页需强校验。
- 验证码的生成、校验与过期策略要完善；避免只依赖前端参数。

## 教学提示
- 2FA 绕过多源于服务端对“已验证状态”的信任不足或校验缺失。