# Level 25 Writeup — 密码重置逻辑缺陷

## 关卡目标
- 利用密码重置流程中的逻辑瑕疵（如令牌可预测、校验缺失、覆盖其他用户）获取或重置账户密码。

## 场景概览
- 登录入口：`level25/login.html`
- 重置申请：`level25/reset-request.html`、`level25/reset-request.php`
- 重置页面：`level25/reset.php`
- 执行重置：`level25/do-reset.php`
- 登录后页：`level25/welcome.html`

## 核心缺陷
- 重置令牌生成或校验不严（可预测、未绑定用户/时间/一次性使用）。

## 攻击步骤
1. 观察令牌格式与传递方式，尝试枚举或构造令牌。
2. 在 `reset.php` 中使用攻击者构造的令牌完成密码重置。

## 验证点与证据
- 抓包对比正常与伪造令牌的行为；检查服务端是否验证令牌绑定的用户名与有效期。

## 修复建议
- 使用加密安全的随机令牌，绑定用户、有效期与一次性使用，重置后使令牌失效。
- 通过邮件或多因素验证确认重置请求。

## 教学提示
- 密码重置流程是高风险点，令牌设计与校验是关键。